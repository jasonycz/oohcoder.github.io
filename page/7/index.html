<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 7 页 | OohCode | 好奇的码农~</title>

  
  <meta name="author" content="sean chen">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="OohCode"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="OohCode" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">OohCode</a>
    </h1>
    <p class="site-description">好奇的码农~</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2013/12/30/jekyll-and-plugin-plantuml/"><span>jekyll添加plantuml模块</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2013/12/30/jekyll-and-plugin-plantuml/" rel="bookmark">
        <time class="entry-date published" datetime="2013-12-29T16:00:00.000Z">
          2013-12-30
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p><em>讲完了如何正常显示中文后，突然想到使用jekyll + plantuml的组合岂不是更加神奇，于是折腾之~</em></p>
</blockquote>
<p>首先plantuml的<a href="http://plantuml.sourceforge.net/running.html" target="_blank" rel="external">running</a>页面列出了plant所支持的平台及编辑器，可以看到jekyll赫然在列，所以如果按照这个<a href="https://github.com/yjpark/jekyll-plantuml" target="_blank" rel="external">教程</a>应该没问题了，可并没有这么简单。<br>这个教程说的是基于octopress的，虽然octopress也是基于jekyll的，可是还是有差别的，按照教程把plugin进去，在build的时候，发现又错误提示：<code>./plugins/raw</code>不存在，这个包确实不存在，加上我队ruby还不熟悉，于是找这个包也找不到，折腾了半天，把行注释掉，又提示了其他的错误，加上jekyll添加plugin我也不是太清楚，所以干脆先放弃，寻找替代方案。</p>
<h2 id="JS实现plantuml渲染">JS实现plantuml渲染</h2><p>越是发现列表页还支持js渲染，如果能直接引用js进行渲染也是不错的选择，于是把完整包下载下来，引入default.html页面中，但是第一次并没有成功，是因为rawdeflate.js是异步加载的，必须使用http协议解析才行，而且jquery_plantuml.js的路径必须要改成你的js文件放置的路径，而且默认渲染的是图片，而我想要矢量图，所以把代码<code>$(this).attr(&quot;src&quot;, &quot;http://www.plantuml.com/plantuml/img/&quot;+encode64(e.data));</code>中的img路径改为了svg就可以了。效果如下:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;img uml=&#34;&#10;Bob -&#62; Alice : Love&#10;&#34;&#62;</span><br></pre></td></tr></table></figure>
<p><img uml="
Bob -> Alice : Love
"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;img uml=&#34;&#10;Bob -&#62; Alice: &#35775;&#38382;&#10;Alice --&#62; Bob: &#21709;&#24212;&#10;&#34;&#62;</span><br></pre></td></tr></table></figure></p>
<p><img uml="
Bob -> Alice: 访问
Alice --> Bob: 响应
"></p>
<p>发现这里有一个问题：第一个可以正常现实，第二个却不能正常现实，原因是传递<code>uml</code>变量的值时，正常的应该是把换行符也传递过去，但是在实际对js传递的参数进行调试的时候换行符不见了。</p>
<h2 id="Plugin实现plantuml渲染">Plugin实现plantuml渲染</h2><p>由于js生产的uml图出现了问题，不能正确解析，而且对泳道图不支持，我只有研究一下真正的plantuml plugin了。<br>还是接着上面的，git地址下载下来<code>plantuml.rb</code>到<code>_plugins/</code>目录后，然后在blog里写出下面的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% plantuml %&#125;&#10;&#10;|Web|&#10;start&#10;:action;&#10;|Server|&#10;:running;&#10;:return;&#10;|Web|&#10;end;&#10;&#10;&#123;% endplantuml %&#125;</span><br></pre></td></tr></table></figure></p>
<p>发现执行<code>jekyll build</code>时会提示不能够加载<code>./plugins/raw</code>, 由于对ruby不熟悉，所以找了好久也没找到这个原因，所以最后还得靠自己，我把加载这个包的代码注释了，又运行了一下build,仔细看了一下出错信息，发现里面有一个错误提示Digest这个执行有问题，发现并没有引入这个包，于是在前面加上了<code>require &quot;digest&quot;</code>，再次运行发现成功了，也生成了图片地址，但是在<code>_site</code>目录里并没有找到这个目录，因为明明在目录里生成了，但是build完后自己又消失了，很奇怪，但是我在网上找了好久也没找到build的内部流程，所以只有另寻出路了，发现<code>_site</code>里面除了生成的<code>blog</code>目录里都是静态博客外，还有一个<code>assets</code>目录，里面正是根目录下的<code>assets</code> copy过来的，所以我想到在<code>assets</code>目录下建立一个plantuml生成文件的路径，果然再次build的时候可以了，但是有一个不好的点就是每次这个目录下的图片不是重新生成的，而且这个不能放到版本控制里。下面就是我的具体修改方案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># _config.yml&#25991;&#20214;&#28155;&#21152;&#19979;&#38754;&#20004;&#34892;&#10;plantuml_jar: ./_lib/plantuml.jar&#10;plantuml_folder: /assets/img/plantuml/&#10;# plantuml.rb &#25991;&#20214;&#28155;&#21152;&#10;require &#39;digest&#39;&#10;&#10;# plantuml.rb &#20462;&#25913;&#29983;&#25104;&#22270;&#29255;&#30340;&#36335;&#24452;&#10;# folder = &#34;/images/plantuml/&#34;&#10;folder = site.config[&#39;plantuml_folder&#39;]&#10;# folderpath = site.dest + folder&#10;folderpath = site.dest + &#34;/..&#34; + folder&#10;# filepath = site.dest + folder + filename&#10;filepath = site.dest + &#34;/..&#34; +folder + filename&#10;&#10;# plantuml.rb &#20462;&#25913;&#29983;&#20135;svg&#21644;&#35299;&#20915;&#20013;&#25991;&#20081;&#30721;&#38382;&#39064;&#10;filename = Digest::MD5.hexdigest(code) + &#34;.svg&#34;&#10;cmd = &#34;java -jar &#34; + plantuml_jar + &#34; -tsvg -charset utf-8 -pipe &#62; &#34; + filepath</span><br></pre></td></tr></table></figure></p>
<p>发现在我的电脑上build后能够正常现实，也不能正常现实，只有先把<code>jekyll serve</code>重启一下才能成功。但是传到git pages上却不行,我还不太清楚github pages的jekyll运行原理与本地有什么区别，该如何去控制github pages的服务器，所以这个方法还是行不通。</p>
<h2 id="JS与Plugin混合渲染plantuml">JS与Plugin混合渲染plantuml</h2><p>上面两个方法都有问题，该如何是好呢？于是我又回到了使用js的想法，因为这个渲染后的结果是通过plantuml服务器保存的，通过仔细观察<code>jquery_plantuml.js</code>的内容我了解到，其实这个js是实现了一个数据压缩的算法，把传递的代码进行压缩，然后生产一个压缩后的字符串，由于字符串和代码内容是一一对应的，所以plantuml服务器就以此字符串为key对应此代码的图片（分别对应svg和png两种格式）。此前能够通过html标签传递代码，但是换行有问题，另一方面直接写html代码也不美观，可不可以把<code>planutml.rb</code>这个plugin改造一下，来传递代码和生成img标签呢？于是再来看plantuml.rb的代码，发现除了中间生产图片的需要用到plantuml.jar，其它的逻辑就是我们刚才想得到的东西，于是把这个插件改造如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module Jekyll&#10;&#10;  class PlantUMLFile &#60; StaticFile&#10;    def write(dest)&#10;      true&#10;    end&#10;  end&#10;&#10;  class PlantUMLBlock &#60; Liquid::Block&#10;    def render(context)&#10;      site = context.registers[:site]&#10;      code = @nodelist.join&#10;      source = &#34;&#60;center&#62;&#34;&#10;      source += &#34;&#60;img alt=&#39;this is uml image&#39; uml=&#39;&#34;+code+&#34;&#39;&#62;&#34;&#10;      source += &#34;&#60;/center&#62;&#34;&#10;      source&#10;    end&#10;  end&#10;end&#10;&#10;Liquid::Template.register_tag(&#39;plantuml&#39;, Jekyll::PlantUMLBlock)</span><br></pre></td></tr></table></figure></p>
<p>plantuml的内容还是第二种方法的内容，效果如下：<br>可以看到这时候plantuml的展示就正常了，而且github pages同样正常了，这时候再把第二种方法说的添加的无用目录<code>img/plantuml/</code>和无用文件<code>plantuml.jar</code>都删除就可以了～(￣▽￣)</p>
<p>但是上传后又发现github pages不能正常显示，真是要命啊！我怀疑是不是自己的环境和github pages的环境不一样导致的，于是我又按照github pages 的<a href="https://help.github.com/articles/using-jekyll-with-pages" target="_blank" rel="external">官方步骤</a>又来了一次，发现这次在本地运行提示不能找到自己定义的tag，这就对了，线上发邮件说也是这个错误。于是我又找了好久原因，原来是<code>safe</code>这个配置导致的，本地默认是false,可以使用第三方插件，如果为<code>true</code>就不能使用第三方插件，而github pages为了保证安全，默认的都是<code>true</code>，也就是说线上不能使用第三方插件！</p>
<h3 id="网站使用静态文件">网站使用静态文件</h3><p>为了支持这个东西我只好再次想办法了，于是找到了一个<a href="http://blog.nitrous.io/2013/08/30/using-jekyll-plugins-on-github-pages.html" target="_blank" rel="external">方法</a>，发现github pages是可以不是用jekyll而使用生成后的静态文件的，步骤如下：</p>
<ul>
<li>新建一个seanerchen.github.io.raw的repo,然后把原来seanerchen.github.io的代码copy过来，放到这个版本控制里管理。</li>
<li>删除seanerchen.github.io的所有文件，然后<code>touch .nojekyll</code>这个文件。</li>
<li>copy -rf seanerchen.github.io.raw/_site/* seanerchen.github.io/</li>
<li>然后把seanerchen.github.io 下的push上去</li>
<li>等待缓冲实效，打开页面。可以了～</li>
</ul>
<p>效果如下：<br><img src="http://www.plantuml.com/plantuml/svg/gmbFJQhXAYv9B2hXiafCBidCpxFcgWbEBIfBBQhXiYegpSlBp4kt1h9IIqgBG79W3QbvATO0"></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/tools/">tools</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/jekyll/">jekyll</a><a href="/tags/plantuml/">plantuml</a>
    </span>
    

    </div>

    
    <div class="article-meta pull-right">
      <span>
        <i class="icon-comments"></i>
        <span>
          <a href="2013/12/30/jekyll-and-plugin-plantuml/#comment">评论</a>
        </span>
      </span>
    </div>
    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2013/12/29/plantuml-chinese-garbled/"><span>plantuml在Mac OS X系统下中文乱码问题解决</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2013/12/29/plantuml-chinese-garbled/" rel="bookmark">
        <time class="entry-date published" datetime="2013-12-28T16:00:00.000Z">
          2013-12-29
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p>安装完plantuml使用plantuml.jar生成的uml图中文会出现乱码，这个问题困扰了我大半天，终于解决了～</p>
</blockquote>
<p>首先编写uml程序的文件的编码方式是utf-8的，test.uml内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@startuml&#10;|Brower|&#10;start&#10;:&#28857;&#20987;&#39046;&#21462;&#25353;&#38062;;&#10;|WebServer|&#10;:&#39046;&#21462;&#21195;&#31456;;&#10;|Cache|&#10;:&#26356;&#26032;&#32531;&#23384;;&#10;|DB|&#10;:&#26356;&#26032;DB;&#10;@enduml</span><br></pre></td></tr></table></figure><br>但是利用<code>java -jar plantuml.jar -tsvg test.uml</code>或者利用plantuml的vim插件命令<code>:make</code>都可以正常生成，但是里面的中文都是乱码。实在是让我发愁啊，在网上找了好久，只有一篇博客提到了这个问题，就是<a href="http://blog.sina.com.cn/s/blog_53e449530101408m.html" target="_blank" rel="external">ubuntu plantuml的中文问题 </a>。但这并不是我想要的，首先我的系统是Mac OS X,跟博文中的系统不一样，其次我的系统对中文编码是支持的，其他的都没问题，只是这里有问题。最后还是自己帮了自己，使用<code>java -jar plantuml.jar -h</code>可以看到有个<code>-charset</code>选项，但是后面说的默认编码格式却是GBK2312，总有找到问题了，于是我在命令里加了下面的参数<code>java -jar plantuml.jar -charset utf-8 -tsvg test.uml</code>，在看结果终于可以了～中文显示正常了！  </p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/tools/">tools</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/plantuml/">plantuml</a>
    </span>
    

    </div>

    
    <div class="article-meta pull-right">
      <span>
        <i class="icon-comments"></i>
        <span>
          <a href="2013/12/29/plantuml-chinese-garbled/#comment">评论</a>
        </span>
      </span>
    </div>
    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2013/12/29/my-tools/"><span>我使用的工具列表</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2013/12/29/my-tools/" rel="bookmark">
        <time class="entry-date published" datetime="2013-12-28T16:00:00.000Z">
          2013-12-29
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p>在码农生涯中我喜欢不断的折腾，在这里我把我自己用的一些工具集中列一下，以便我自己进行总结，也希望能给看到的人一些帮助～</p>
</blockquote>
<h1 id="工具列表">工具列表</h1><ul>
<li>VIM: 编辑器</li>
<li>Jekyll: 写博客</li>
<li>plantuml: 生成UML图</li>
<li>markdown: 文档写作格式  </li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/tools/">tools</a>
    </span>
    

    

    </div>

    
    <div class="article-meta pull-right">
      <span>
        <i class="icon-comments"></i>
        <span>
          <a href="2013/12/29/my-tools/#comment">评论</a>
        </span>
      </span>
    </div>
    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2013/12/26/mysql-optimiz-summary/"><span>MySQL优化总结</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2013/12/26/mysql-optimiz-summary/" rel="bookmark">
        <time class="entry-date published" datetime="2013-12-25T16:00:00.000Z">
          2013-12-26
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p><em>这篇博客主要就mysql的优化进行问题从不同方面进行了总结。</em></p>
</blockquote>
<h2 id="基础知识">基础知识</h2><p>通常意义上，数据库也就是数据的集合，具体到计算机上数据库可以是存储器上一些文件的集合或者一些内存数据的集合。MySql数据库是开放源代码的关系型数据库。目前，它可以提供的功能有：支持sql语言、子查询、存储过程、触发器、视图、索引、事务、锁、外键约束和影像复制等。MySql也是客户/服务器系统并且是<strong>单进程多线程架构</strong>的数据库。MySql区别于其它数据库系统的一个重要特点是支持<strong>插入式存储引擎</strong>。</p>
<h3 id="存储引擎">存储引擎</h3><p>根据存储数据及为数据建立索引和更新、查询技术的不同可以将mysql的存储分为不同的存储引擎，其中最主要的存储引擎有MyISAM、InnoDB、MEMORY等，其中最常用的有MyISAM和InnoDB两种，可以通过下面的命令查看自己的MySQL支持哪些存储引擎：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&#62; SHOW ENGINES;&#10;+------------+---------+------------------------------------------------------------+--------------+------+------------+&#10;| Engine     | Support | Comment                                                    | Transactions | XA   | Savepoints |&#10;+------------+---------+------------------------------------------------------------+--------------+------+------------+&#10;| MRG_MYISAM | YES     | Collection of identical MyISAM tables                      | NO           | NO   | NO         |&#10;| CSV        | YES     | CSV storage engine                                         | NO           | NO   | NO         |&#10;| MyISAM     | DEFAULT | Default engine as of MySQL 3.23 with great performance     | NO           | NO   | NO         |&#10;| InnoDB     | YES     | Supports transactions, row-level locking, and foreign keys | YES          | YES  | YES        |&#10;| MEMORY     | YES     | Hash based, stored in memory, useful for temporary tables  | NO           | NO   | NO         |&#10;+------------+---------+------------------------------------------------------------+--------------+------+------------+&#10;5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p><strong>MyISAM</strong>:这种引擎是mysql最早提供的。这种引擎又可以分为静态MyISAM、动态MyISAM 和压缩MyISAM三种：</p>
<ul>
<li>静态MyISAM：如果数据表中的各数据列的长度都是预先固定好的，服务器将自动选择这种表类型。因为数据表中每一条记录所占用的空间都是一样的，所以这种表存取和更新的效率非常高。当数据受损时，恢复工作也比较容易做。</li>
<li>动态MyISAM：如果数据表中出现varchar、xxxtext或xxxBLOB字段时，服务器将自动选择这种表类型。相对于静态MyISAM，这种表存储空间比较小，但由于每条记录的长度不一，所以多次修改数据后，数据表中的数据就可能离散的存储在内存中，进而导致执行效率下降。同时，内存中也可能会出现很多碎片。因此，这种类型的表要经常用optimize table 命令或优化工具来进行碎片整理。</li>
<li><p>压缩MyISAM：以上说到的两种类型的表都可以用myisamchk工具压缩。这种类型的表进一步减小了占用的存储，但是这种表压缩之后不能再被修改。另外，因为是压缩数据，所以这种表在读取的时候要先时行解压缩。</p>
<p>但是，不管是何种MyISAM表，目前它都不支持事务，行级锁和外键约束的功能。</p>
</li>
</ul>
</li>
<li><strong>MyISAM Merge</strong>：这种类型是MyISAM类型的一种变种。合并表是将几个相同的MyISAM表合并为一个虚表。常应用于日志和数据仓库。</li>
<li><strong>InnoDB</strong>：InnoDB表类型可以看作是对MyISAM的进一步更新产品，它提供了事务、行级锁机制和外键约束的功能。</li>
<li><strong>memory(heap)</strong>：这种类型的数据表只存在于内存中。它使用散列索引，所以数据的存取速度非常快。因为是存在于内存中，所以这种类型常应用于临时表中。</li>
<li><strong>archive</strong>：这种类型只支持select 和 insert语句，而且不支持索引。常应用于日志记录和聚合分析方面。</li>
</ul>
<h3 id="索引">索引</h3><h4 id="索引用到的数据结构">索引用到的数据结构</h4><p>关于存储引擎用的数据结构其中最重要的就是B树与B+树，可以参考JULY的这篇<a href="http://blog.csdn.net/v_july_v/article/details/6530142" target="_blank" rel="external">从B 树、B+ 树、B* 树谈到R 树</a>。<br>可以看到，B树与B+树的最大的区别其实就是：B树的所有信息都存在字节点中，而B+树的所有信息都存储在叶子节点中。<br>B+树比B树更适合做文件索引和数据库索引，原因是：</p>
<ol>
<li>B+-tree的磁盘读写代价更低<br>B+-tree的内部结点并没有指向关键字具体信息的指针。因此其内部结点相对B 树更小。如果把所有同一内部结点的关键字存放在同一盘块中，那么盘块所能容纳的关键字数量也越多。一次性读入内存中的需要查找的关键字也就越多。相对来说IO读写次数也就降低了。<br> 举个例子，假设磁盘中的一个盘块容纳16bytes，而一个关键字2bytes，一个关键字具体信息指针2bytes。一棵9阶B-tree(一个结点最多8个关键字)的内部结点需要2个盘快。而B+ 树内部结点只需要1个盘快。当需要把内部结点读入内存中的时候，B 树就比B+ 树多一次盘块查找时间(在磁盘中就是盘片旋转的时间)。</li>
<li><p>B+-tree的查询效率更加稳定<br>由于非终结点并不是最终指向文件内容的结点，而只是叶子结点中关键字的索引。所以任何关键字的查找必须走一条从根结点到叶子结点的路。所有关键字查询的路径长度相同，导致每一个数据的查询效率相当。<br>读者点评</p>
</li>
<li><p>有人觉得这两个原因都不是主要原因。数据库索引采用B+树的主要原因是 B树在提高了磁盘IO性能的同时并没有解决元素遍历的效率低下的问题。正是为了解决这个问题，B+树应运而生。B+树只要遍历叶子节点就可以实现整棵树的遍历。而且在数据库中基于范围的查询是非常频繁的，而B树不支持这样的操作（或者说效率太低）。</p>
</li>
</ol>
<h4 id="索引的分类">索引的分类</h4><p>MySQL数据库可以建立不同的数据库，主要类型有：</p>
<ul>
<li><strong>普通索引</strong>:就是普通的INDEX。索引的列可以重复。</li>
<li><strong>唯一索引</strong>:UNIQUE INDEX ,索引的列值必须使唯一，可以有空值，如果是组合索引，则列值的组合必须使唯一的。<strong>主键索引</strong>是一种特殊的唯一索引，不允许为空值，一个表只能有一个主键。</li>
<li><strong>全文索引</strong>:FULLTEXT索引，把CHAR、VARCHAR或TEXT列作为索引，仅可以用于MyISAM表中。</li>
<li><strong>组合索引（最左前缀）</strong>:对个列组合成为一个索引。这个索引其实只是上面几种的一个特殊情况。</li>
</ul>
<h3 id="存储引擎对索引的利用">存储引擎对索引的利用</h3><p>关于存储引擎及其使用的数据结构可以看下这个博客：<a href="http://blog.linezing.com/2011/07/%E6%B5%85%E8%B0%88mysql%E7%B4%A2%E5%BC%95%E8%83%8C%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95" target="_blank" rel="external">浅谈mysql索引背后的数据结构及算法</a>。<br>这篇博客讲的很清楚了，但是这里我还是要总结一下重点，便于自己记忆。</p>
<ol>
<li>MyISAM与InnoDB使用的都是B+树作为索引</li>
<li><p>MyISAM使用B+树的方式如下：</p>
<ul>
<li>对于主键索引：<br><img src="/assets/img/others/myisam_primary_key.png" alt="primary key"></li>
<li>对于辅助索引：<br><img src="/assets/img/others/myisam_secondary_key.png" alt="primary key"><br>可见它主要是MyISAM的叶子节点存储的是数据的地址，索引文件与数据是分离的，当查询时先从索引文件中找到数据的地址，然后再根据地址去取出数据的值。主索引与普通索引的查询方法是一致的。</li>
</ul>
</li>
<li><p>InnoDB使用B+树的方式如下： </p>
<ul>
<li>对于主键索引：<br><img src="/assets/img/others/innodb_primary_key.png" alt="primary key"></li>
<li>对于辅助索引：<br><img src="/assets/img/others/innodb_secondary_key.png" alt="primary key"><br>可以看出与MyISAM不同，InnoDB的数据文件同时也是索引文件，对于主键索引的使用，就是直接从索引文件的叶子节点中找出数据。但是普通索引所有的叶子节点存储的都是主键的值，对于普通索引只能先通过索引文件找出主键的值，然后再根据主键的值从主键索引文件中找出数据。<br>ps:有点疑问：前面说选择B+Tree作为存储引擎数据结构的原因第一条是索引文件比较小，可以放到同一个磁盘上，减少磁盘的读取次数，所以效率比较高，但是这个把索引文件和数据融到了一起，是不是也会有这个问题呢？</li>
</ul>
</li>
</ol>
<h4 id="存储引擎适用的场景">存储引擎适用的场景</h4><p>只有了解存储引擎的原理才能更好的进行优化，其实优化就是根据其原理把数据库的性能提升到尽可能的高。</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/DB/">DB</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/mysql/">mysql</a>
    </span>
    

    </div>

    
    <div class="article-meta pull-right">
      <span>
        <i class="icon-comments"></i>
        <span>
          <a href="2013/12/26/mysql-optimiz-summary/#comment">评论</a>
        </span>
      </span>
    </div>
    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2013/12/24/markdown-to-pdf/"><span>markdown转pdf</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2013/12/24/markdown-to-pdf/" rel="bookmark">
        <time class="entry-date published" datetime="2013-12-23T16:00:00.000Z">
          2013-12-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <blockquote>
<p><em>现在已经对markdown痴迷了，一直在折腾，想以后把markdown 作为我不管是写博客还是写文档的标准文件格式，因为据说它可以转换成很多其他的格式，适应在不同的设备上使用，这就是一劳永逸啊。可以过程却是很坑爹啊～</em></p>
</blockquote>
<h2 id="工具选择">工具选择</h2><p>Google 了很久，终于发现一个强大的工具：<a href="http://johnmacfarlane.net/pandoc/" target="_blank" rel="external">pandoc</a>。于是苦逼的旅程开始了～</p>
<h3 id="linux下安装：">linux下安装：</h3><ol>
<li>pandoc<a href="http://johnmacfarlane.net/pandoc/installing.html" target="_blank" rel="external">下载安装</a>页面竟然没有redhat?</li>
<li>查看一下发现有一个<a href="http://johnmacfarlane.net/pandoc/installing.html#all-platforms" target="_blank" rel="external">all-platforms</a></li>
<li>提示需要先安装<a href="http://www.haskell.org/platform/" target="_blank" rel="external">Haskell platform</a></li>
<li>选择linux平台却发现没有redhat,只是看到不起眼的一行写着：<em>See also: <a href="http://justhub.org/" target="_blank" rel="external">justhub</a>, for RHEL, CentOS, Scientific Linux, and Fedora support</em>.</li>
<li>进入下载页面总于看到希望了：<br><code>wget http://sherkin.justhub.org/el6/RPMS/x86_64/justhub-release-2.0-4.0.el6.x86_64.rpm</code><br><code>rpm -ivh justhub-release-2.0-4.0.el6.x86_64.rp</code><br><code>yum install haskell</code><br>尼玛，这个也太大了，要一个多G,我的<code>usr</code>都满了～</li>
<li>再回到pandoc的<a href="http://johnmacfarlane.net/pandoc/installing.html" target="_blank" rel="external">下载页面</a>执行：<code>cabal install --force pandoc pandoc-citeproc</code></li>
<li>果然又报错:<code>pandoc-1.12.2.1 failed during the building phase.</code>,找了好久，还是<a href="http://stackoverflow.com/questions/19045380/failed-to-compile-pandoc-with-cabal" target="_blank" rel="external">stackoverflow</a>靠谱，原来是内存不够用了！果断把其它进程kill了，腾出空间再次运行～</li>
<li>终于看到安装成功的提示了，-_-#。来，运行一个pandoc命令看看：<code>pandoc -V</code>,竟然提示command no found!!!＿|￣|○</li>
<li>找找有没有pandoc吧：<code>find / -name pandoc</code>果然找到了，二进制文件在这里：<code>/root/.cabal/bin/pandoc</code>。把它们加到PATH里，退出再登录一把。</li>
<li>Y(^_^)Y，终于好了！！！</li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/tools/">tools</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/markdown/">markdown</a>
    </span>
    

    </div>

    
    <div class="article-meta pull-right">
      <span>
        <i class="icon-comments"></i>
        <span>
          <a href="2013/12/24/markdown-to-pdf/#comment">评论</a>
        </span>
      </span>
    </div>
    
  </div>
</article>




<nav class="pagination">
  
  <a href="/page/6/" class="pagination-prev">上一页</a>
  
  
  <a href="/page/8/" class="pagination-next">下一页</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2017 sean chen
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>